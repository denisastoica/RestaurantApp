<Page x:Class="Restaurant.Views.AdminPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:services="clr-namespace:Restaurant.Services"
      Title="Panou Administrare">

    <Page.Resources>
        <SolidColorBrush x:Key="AccentBrush" Color="#E7929C"/>
        <SolidColorBrush x:Key="PanelBrush"  Color="#616161"/>
        <SolidColorBrush x:Key="BgBrush"     Color="#FFF0E5F0"/>

        <Style TargetType="Button">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Padding" Value="6"/>
            <Setter Property="Margin" Value="4"/>
            <Setter Property="Background" Value="{StaticResource AccentBrush}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>

        <services:NullToBoolConverter x:Key="NullToBoolConverter"/>
    </Page.Resources>

    <Grid Background="{StaticResource BgBrush}" Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <TextBlock Text="Panou Administrare" 
                   FontSize="24" FontWeight="Bold" 
                   Foreground="{StaticResource PanelBrush}"
                   Margin="0,0,0,10"/>

        <TabControl Grid.Row="1"
                    SelectedIndex="{Binding AdminTabIndex, Mode=TwoWay}">
            <TabItem Header="Categorii">
                <Grid Margin="10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*"/>
                        <ColumnDefinition Width="3*"/>
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Column="0">
                        <ListBox ItemsSource="{Binding Categories}" 
                                 SelectedItem="{Binding SelectedCategory}"
                                 DisplayMemberPath="Name" Height="200"/>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                            <Button Content="Adaugă" Command="{Binding AddCategoryCommand}"/>
                            <Button Content="Edit"  Command="{Binding EditCategoryCommand}"/>
                            <Button Content="Șterge" Command="{Binding DeleteCategoryCommand}"/>
                        </StackPanel>
                    </StackPanel>
                    <StackPanel Grid.Column="1" Margin="20,0,0,0">
                        <TextBlock Text="Denumire categorie:"/>
                        <TextBox Text="{Binding CategoryName}" />
                    </StackPanel>
                </Grid>
            </TabItem>

            <TabItem Header="Preparate">
                <Grid Margin="10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*"/>
                        <ColumnDefinition Width="3*"/>
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Column="0">
                        <ListBox ItemsSource="{Binding Products}" 
                                 SelectedItem="{Binding SelectedProduct}"
                                 DisplayMemberPath="Name" Height="200"/>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                            <Button Content="Adaugă" Command="{Binding AddProductCommand}"/>
                            <Button Content="Edit"  Command="{Binding EditProductCommand}"/>
                            <Button Content="Șterge" Command="{Binding DeleteProductCommand}"/>
                        </StackPanel>
                    </StackPanel>
                    <StackPanel Grid.Column="1" Margin="20,0,0,0">
                        <TextBlock Text="Denumire:"/>
                        <TextBox Text="{Binding ProductName}" />
                        <TextBlock Text="Preț:" Margin="0,10,0,0"/>
                        <TextBox Text="{Binding ProductPrice}" />
                        <TextBlock Text="Cantitate portie:" Margin="0,10,0,0"/>
                        <TextBox Text="{Binding ProductPortion}"/>
                    </StackPanel>
                </Grid>
            </TabItem>

            <TabItem Header="Meniuri">
                <Grid Margin="10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*"/>
                        <ColumnDefinition Width="3*"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0">
                        <ListBox ItemsSource="{Binding Menus}"
               SelectedItem="{Binding SelectedMenu}"
               DisplayMemberPath="Name"
               Height="200"/>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                            <Button Content="Adaugă" Command="{Binding AddMenuCommand}" />
                            <Button Content="Edit"  Command="{Binding EditMenuCommand}" />
                            <Button Content="Şterge"
                Command="{Binding DeleteMenuCommand}"
                CommandParameter="{Binding SelectedMenu}"
                IsEnabled="{Binding SelectedMenu, Converter={StaticResource NullToBoolConverter}}"/>
                        </StackPanel>
                    </StackPanel>

                    <StackPanel Grid.Column="1" Margin="20,0,0,0">
                        <TextBlock Text="Denumire meniu:"/>
                        <TextBox Text="{Binding MenuName}" Margin="0,5"/>

                        <TextBlock Text="Reducere (%)" Margin="0,10,0,0"/>
                        <TextBox Text="{Binding MenuDiscountPercent}" Margin="0,5"/>

                        <TextBlock Text="Categorie meniu:" Margin="0,10,0,0"/>
                        <ComboBox ItemsSource="{Binding Categories}"
                SelectedItem="{Binding SelectedMenuCategory}"
                DisplayMemberPath="Name"
                Margin="0,5"/>

                        <TextBlock Text="Alege preparatele:" FontWeight="Bold" Margin="0,20,0,5"/>
                        <ListBox ItemsSource="{Binding AllProducts}"
               SelectionMode="Multiple"
               DisplayMemberPath="Name"
               Height="150"
               services:ListBoxHelper.SelectedItems="{Binding SelectedMenuProducts}"
               BorderBrush="Gray" BorderThickness="1"/>
                        <TextBlock Text="Conținut meniu:" FontWeight="Bold" Margin="0,20,0,5"/>
                        <ItemsControl ItemsSource="{Binding SelectedMenuContents}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding Name}" />
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>


                    </StackPanel>
                </Grid>
            </TabItem>

            <TabItem Header="Comenzi">
                <Frame x:Name="AdminOrdersFrame"/>
            </TabItem>

            <TabItem Header="Stoc redus">
                <Frame x:Name="LowStockFrame"/>
            </TabItem>

            <TabItem Header="Alergeni">
                <Grid Margin="10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*"/>
                        <ColumnDefinition Width="3*"/>
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Column="0">
                        <ListBox ItemsSource="{Binding Allergens}" 
                                 SelectedItem="{Binding SelectedAllergen}"
                                 DisplayMemberPath="Name" Height="200"/>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                            <Button Content="Adaugă" Command="{Binding AddAllergenCommand}"/>
                            <Button Content="Edit"  Command="{Binding EditAllergenCommand}"/>
                            <Button Content="Șterge" Command="{Binding DeleteAllergenCommand}"/>
                        </StackPanel>
                    </StackPanel>
                    <StackPanel Grid.Column="1" Margin="20,0,0,0">
                        <TextBlock Text="Denumire alergen:" FontWeight="Bold"/>
                        <TextBox Text="{Binding AllergenName}" Margin="0,0,0,10"/>

                        <TextBlock Text="Produse care conțin acest alergen:" 
                                   FontWeight="Bold" Margin="0,10,0,5"/>

                        <ListBox ItemsSource="{Binding SelectedAllergenProducts}"
                                 SelectedItem="{Binding SelectedProductForAllergen}"
                                 DisplayMemberPath="Name" 
                                 Height="150"
                                 BorderBrush="Gray"
                                 BorderThickness="1"/>

                        <Button Content="Edit produs"
                                Command="{Binding EditAllergenProductCommand}"
                                CommandParameter="{Binding SelectedProductForAllergen}"
                                IsEnabled="{Binding SelectedProductForAllergen, Converter={StaticResource NullToBoolConverter}}"
                                Width="100"
                                Margin="0,8,0,0"/>
                    </StackPanel>
                </Grid>
            </TabItem>
        </TabControl>
    </Grid>
</Page>
