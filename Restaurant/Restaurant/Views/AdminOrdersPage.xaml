<Page x:Class="Restaurant.Views.AdminOrdersPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:vm="clr-namespace:Restaurant.ViewModels"
      xmlns:services="clr-namespace:Restaurant.Services"
      Title="Comenzi">

    <Page.Resources>
        <services:StatusToBoolConverter x:Key="StatusToBoolConverter"/>
    </Page.Resources>

    <Grid Margin="20">
        <StackPanel>
            <TextBlock Text="Comenzi înregistrate" FontWeight="Bold" FontSize="20" Margin="0,0,0,10"/>
            <DataGrid ItemsSource="{Binding Orders}" AutoGenerateColumns="False" Height="350" Margin="0,10,0,0">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Cod" Binding="{Binding Code}" />
                    <DataGridTextColumn Header="Data" Binding="{Binding Date, StringFormat=dd.MM.yyyy HH:mm}" />
                    <DataGridTextColumn Header="Livrare estimată" Binding="{Binding DeliveryEta, StringFormat=dd.MM.yyyy HH:mm}" />


                    <DataGridTextColumn Header="Status" Binding="{Binding StatusText}" />

                    <DataGridTextColumn Header="Produse/Meniuri" Binding="{Binding Items}" Width="250" />
                    <DataGridTextColumn Header="Total" Binding="{Binding TotalCost, StringFormat={}{0:F2} lei}" />
                    <DataGridTextColumn Header="Client" Binding="{Binding ClientName}" />
                    <DataGridTextColumn Header="Telefon" Binding="{Binding ClientPhone}" />
                    <DataGridTextColumn Header="Adresă" Binding="{Binding ClientAddress}" />
                    <DataGridTemplateColumn Header="Status +1">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <Button Content="Avansează"
                                        Command="{Binding DataContext.ChangeStatusCommand, RelativeSource={RelativeSource AncestorType=Page}}"
                                        CommandParameter="{Binding}"
                                        IsEnabled="{Binding StatusText, Converter={StaticResource StatusToBoolConverter}}"
                                        Width="90"/>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>
            <Button Content="Reîmprospătează" Command="{Binding RefreshCommand}" Margin="0,10,0,0"/>
        </StackPanel>
    </Grid>
</Page>
